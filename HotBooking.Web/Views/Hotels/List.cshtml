
@model BrowseHotelsViewModel

@{
    ViewData["Title"] = "Explore Hotels";
}

<section>
    <form asp-action="List" method="get">
        <div class="input-group mb-3">
            <input id="searchBar"
                   type="text"
                   class="form-control"
                   placeholder="Search"
                   name="city"
                   value="@Model.City">
            <input type="hidden" id="citiesData" value="@Model.CitiesJson" />
            <button class="btn btn-outline-secondary" type="submit">Search</button>
        </div>
    </form>
</section>

<section>
    <form asp-action="List" method="get">
        <div class="dropdown">
            <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton" data-bs-toggle="dropdown">
                Sort By
            </button>
            <ul class="dropdown-menu">
                <li><a class="dropdown-item" asp-route-city="@Model.City" asp-route-sorting="@HotelSorting.RatingDesc">Top Rated</a></li>
                <li><a class="dropdown-item" asp-route-city="@Model.City" asp-route-sorting="@HotelSorting.PriceAsc">From Cheapest to Most Expensive</a></li>
                <li><a class="dropdown-item" asp-route-city="@Model.City" asp-route-sorting="@HotelSorting.PriceDesc">From Most Expensive to Cheapest</a></li>
            </ul>
        </div>
    </form>
</section>

<partial name="_Pagination" model="@Model.Pager" />

<section class="hotel-item container-fluid">
    @foreach (var hotel in Model.Hotels)
    {
        <div class="row border border-1 border-secondary rounded-3 mb-4">
            <div class="col-12 col-md-4 p-0">
                <img class="img-fluid rounded-3" src="@hotel.ImageUrl" alt="no">
            </div>
            <div class="col-12 col-md-4 p-4">
                <h3>@hotel.HotelName</h3>
                <div class="d-flex gap-1">
                    @for (int i = 0; i < hotel.StarRating; ++i)
                    {
                        <div class="svg-container svg-star">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="gold">
                                <path d="M23.555 8.729a1.505 1.505 0 0 0-1.406-.98h-6.087a.5.5 0 0 1-.472-.334l-2.185-6.193a1.5 1.5 0 0 0-2.81 0l-.005.016-2.18 6.177a.5.5 0 0 1-.471.334H1.85A1.5 1.5 0 0 0 .887 10.4l5.184 4.3a.5.5 0 0 1 .155.543l-2.178 6.531a1.5 1.5 0 0 0 2.31 1.684l5.346-3.92a.5.5 0 0 1 .591 0l5.344 3.919a1.5 1.5 0 0 0 2.312-1.683l-2.178-6.535a.5.5 0 0 1 .155-.543l5.194-4.306a1.5 1.5 0 0 0 .433-1.661z"></path>
                            </svg>
                        </div>
                    }
                </div>
                <p class="text-primary">@hotel.FullAddress</p>
                <p>@hotel.Description</p>
            </div>
            <div class="col-12 col-md-4 p-4 d-flex flex-column justify-content-between">
                <div>
                    <p class="text-end">@hotel.AverageRating/10</p>
                    <p class="text-end">@hotel.ReviewsCount reviews</p>
                </div>
                <button type="button" class="btn btn-outline-primary float-end mt-auto">Check Prices</button>
            </div>
        </div>
    }
</section>

<partial name="_Pagination" model="@Model.Pager" />

@section Scripts {
    <script>
        $(document).ready(function () {
            var availableStrings = JSON.parse($('#citiesData').val());

            $('#searchBar').autocomplete({
                source: availableStrings
            });
        });
    </script>
}
